clear all; close all;data_dir = "/Users/ray/Desktop/training_set/";dog1 = imread(strcat(data_dir,"dog1.jpeg"));dog2 = imread(strcat(data_dir,"dog2.jpeg"));dog3 = imread(strcat(data_dir,"dog3.jpeg"));dog4 = imread(strcat(data_dir,"dog4.jpeg"));cat1 = imread(strcat(data_dir,"cat1.jpeg"));cat2 = imread(strcat(data_dir,"cat2.jpeg"));cat3 = imread(strcat(data_dir,"cat3.jpeg"));cat4 = imread(strcat(data_dir,"cat4.jpeg"));#A = double(rgb2gray(dog1));#pcolor(flipud(A)), shading interp, colormap(gray);function A = transform(matrix)  #minElm = min(matrix(:));  #maxElm = max(max(matrix(:)));  #scaled_matrix = (matrix)/(maxElm);  gray_matrix = rgb2gray(matrix);  maxElm = max(max(gray_matrix(:)));  gray_matrix = gray_matrix / maxElm;  trans_matrix = imresize(double(gray_matrix), [120, 80]);  A = trans_matrix * double(maxElm);  return;endfunction   A = transform(dog1); D1 = A; A = transform(dog2); D2 = A; A = transform(dog3); D3 = A; A = transform(dog4); D4 = A;  A = transform(cat1); C1 = A; A = transform(cat2); C2 = A; A = transform(cat3); C3 = A; A = transform(cat4); C4 = A;   figure(1), subplot(2,4,1), pcolor(flipud(D1)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(2,4,2), pcolor(flipud(D2)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(2,4,3), pcolor(flipud(D3)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(2,4,4), pcolor(flipud(D4)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', [])  subplot(2,4,5), pcolor(flipud(C1)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(2,4,6), pcolor(flipud(C2)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(2,4,7), pcolor(flipud(C3)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(2,4,8), pcolor(flipud(C4)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) AVG_Dog = (D1 + D2 + D3 + D4)/4;  AVG_Cat = (C1 + C2 + C3 + C4)/4;  figure(2), subplot(1,2,1), pcolor(flipud(AVG_Dog)),shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(1,2,2), pcolor(flipud(AVG_Cat)),shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) #break # data matrix D = [reshape(D1, 1, 120 * 80); reshape(D2, 1, 120 * 80); reshape(D3, 1, 120 * 80); reshape(D4, 1, 120 * 80); reshape(C1, 1, 120*80); reshape(C2, 1, 120*80); reshape(C3, 1, 120*80); reshape(C4, 1, 120*80) ];  # correlation matrix C = (D')*D; [V,D] = eigs(C, 8, 'lm'); # Or #[U,S,V] = svd(C)  # Project a single image onto our eigenspace figure(3), subplot(2,2,1), dog = reshape(V(:,1), 120, 80); pcolor(flipud(dog)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(2,2,2), dog = reshape(V(:,2), 120, 80); pcolor(flipud(dog)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(2,2,3), dog = reshape(V(:,3), 120, 80); pcolor(flipud(dog)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', []) subplot(2,2,4), dog = reshape(V(:,4), 120, 80); pcolor(flipud(dog)), shading interp, colormap(gray), set(gca, 'Xtick', [], 'Ytick', [])  figure(4), vecD = reshape(AVG_Dog, 1, 120*80); vecC = reshape(AVG_Cat, 1, 120*80);  projD = vecD * V; projC = vecC * V;  subplot(3, 2, 1), bar(projD(2:8)), set(gca, 'Xtick', [], 'Ytick', []), text(8, -1000, 'Dog') subplot(3, 2, 2), bar(projC(2:8)), set(gca, 'Xtick', [], 'Ytick', []), text(8, -1000, 'Cat') #break  # test test = imread(strcat(data_dir,"cat5.jpeg")); A = transform(test); T = A; vecT = reshape(T, 1, 120*80); projT = vecT * V; subplot(3,2,3), bar(projT(2:8)), set(gca, 'Xtick', [], 'Ytick', []), text(8, -1000, 'Test') subplot(3,2,5), bar(projT(2:8) - projD(2:8)), set(gca, 'Xtick', [], 'Ytick', []), text(8, -1000, 'Dog diff') subplot(3,2,6), bar(projT(2:8) - projC(2:8)), set(gca, 'Xtick', [], 'Ytick', []), text(8, -1000, 'Cat diff')